import"../chunks/Bzak7iHL.js";import"../chunks/B8zN5-cI.js";import{o as ve}from"../chunks/Dh_dsFNd.js";import{aa as ce,b as R,ab as E,a7 as s,a as r,ac as fe,ad as i,ae as l,ah as t,af as o,t as pe,ag as n,n as D,ai as y}from"../chunks/BVWwdZHL.js";import{e as S,s as F}from"../chunks/B8z2uk3R.js";import{i as f}from"../chunks/CcW0RJpt.js";import{r as G,a as P}from"../chunks/DkRgT0vW.js";import{b as J}from"../chunks/Dtqw5nwn.js";import{b as ue}from"../chunks/Bno3tw64.js";import{i as me}from"../chunks/DiBsknOO.js";import{s as O}from"../chunks/DwOm6FZI.js";var ye=R('<div class="note svelte-14yc92f">Restoring session... <span class="loader svelte-14yc92f" aria-hidden="true"></span></div>'),be=R('<div class="error svelte-14yc92f" role="alert">Invalid or missing reset token. You can request a new password reset link.</div> <div style="display:flex;gap:8px;margin-bottom:12px;"><a class="submit-btn svelte-14yc92f" href="/forgot-password" style="text-align:center;display:inline-block;flex:1;">Request password reset</a> <a href="/login" class="field-action svelte-14yc92f" style="align-self:center;">Back to login</a></div>',1),we=R('<div class="error svelte-14yc92f" role="alert"> </div>'),_e=R('<div class="success svelte-14yc92f" role="status"> </div>'),he=R('<div class="container svelte-14yc92f"><div class="card svelte-14yc92f" role="main" aria-labelledby="reset-title"><div class="brand svelte-14yc92f"><div class="logo svelte-14yc92f">B</div> <div><h1 id="reset-title" class="svelte-14yc92f">Reset your password</h1> <div class="muted svelte-14yc92f">Enter a new password to finish resetting your account.</div></div></div> <!> <!> <!> <!> <div class="input-row svelte-14yc92f"><input class="input-field svelte-14yc92f" placeholder="New password" aria-label="New password"/> <button class="field-action svelte-14yc92f" type="button" aria-label="Toggle show password"><!></button></div> <div class="input-row svelte-14yc92f"><input class="input-field svelte-14yc92f" placeholder="Confirm password" aria-label="Confirm password"/> <button class="field-action svelte-14yc92f" type="button" aria-label="Toggle show confirm"><!></button></div> <div class="note svelte-14yc92f">Use a strong password. We recommend 8+ characters with numbers or symbols.</div> <button class="submit-btn svelte-14yc92f"><!></button> <div class="footer svelte-14yc92f"><div><a href="/login" class="svelte-14yc92f">Back to login</a></div> <div class="muted svelte-14yc92f">Need help? <a href="/help" style="color:#9fb3f8" class="svelte-14yc92f">Contact support</a></div></div></div></div>');function qe(Q,V){ce(V,!1);let p=o(""),b=o(""),d=o(""),C=o(""),T=o(!1),H=o(!0),w=o(!1),_=o(!1),h=o(!1),v=o(!1),U=o(null);ve(async()=>{var z;const e=new URLSearchParams(window.location.hash.substring(1)),a=e.get("access_token"),m=e.get("refresh_token");if(a&&m){const{error:A}=await O.auth.setSession({access_token:a,refresh_token:m});A?t(d,A.message):t(T,!0)}else t(v,!0);t(H,!1),s(T)&&(await pe(),(z=s(U))==null||z.focus())});async function I(){if(t(d,""),t(C,""),!s(T)){t(d,"Session not restored yet");return}if(!s(p)||!s(b)){t(d,"Please fill both fields");return}if(s(p)!==s(b)){t(d,"Passwords do not match");return}t(w,!0);const{error:e}=await O.auth.updateUser({password:s(p)});t(w,!1),e?t(d,e.message):(t(C,"Password updated! Redirecting to login..."),setTimeout(()=>window.location.href="/login",1200))}function M(e){e.key==="Enter"&&I()}me();var B=he(),K=l(B),L=i(l(K),2);{var X=e=>{var a=ye();r(e,a)};f(L,e=>{s(H)&&e(X)})}var W=i(L,2);{var Z=e=>{var a=be();D(2),r(e,a)};f(W,e=>{s(v)&&e(Z)})}var Y=i(W,2);{var $=e=>{var a=we(),m=l(a,!0);n(a),E(()=>F(m,s(d))),r(e,a)};f(Y,e=>{s(d)&&e($)})}var j=i(Y,2);{var ee=e=>{var a=_e(),m=l(a,!0);n(a),E(()=>F(m,s(C))),r(e,a)};f(j,e=>{s(C)&&e(ee)})}var N=i(j,2),c=l(N);G(c),ue(c,e=>t(U,e),()=>s(U));var g=i(c,2),se=l(g);{var ae=e=>{var a=y("Hide");r(e,a)},te=e=>{var a=y("Show");r(e,a)};f(se,e=>{s(_)?e(ae):e(te,!1)})}n(g),n(N);var q=i(N,2),u=l(q);G(u);var x=i(u,2),re=l(x);{var oe=e=>{var a=y("Hide");r(e,a)},ie=e=>{var a=y("Show");r(e,a)};f(re,e=>{s(h)?e(oe):e(ie,!1)})}n(x),n(q);var k=i(q,4),le=l(k);{var ne=e=>{var a=y("Saving...");r(e,a)},de=e=>{var a=y("Update password");r(e,a)};f(le,e=>{s(w)?e(ne):e(de,!1)})}n(k),D(2),n(K),n(B),E(()=>{P(c,"type",s(_)?"text":"password"),c.disabled=s(v),P(g,"aria-pressed",s(_)),g.disabled=s(v),P(u,"type",s(h)?"text":"password"),u.disabled=s(v),P(x,"aria-pressed",s(h)),x.disabled=s(v),k.disabled=s(v)||!s(T)||!s(p)||!s(b)||s(w),P(k,"aria-busy",s(w))}),J(c,()=>s(p),e=>t(p,e)),S("keydown",c,M),S("click",g,()=>t(_,!s(_))),J(u,()=>s(b),e=>t(b,e)),S("keydown",u,M),S("click",x,()=>t(h,!s(h))),S("click",k,I),r(Q,B),fe()}export{qe as component};
